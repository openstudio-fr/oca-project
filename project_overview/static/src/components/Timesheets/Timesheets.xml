<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">
  <t t-name="project_overview.Timesheets" owl="1">
    <div class="o_project_overview_timesheets">
      <h3 name="table_plan_title">Timesheets</h3>
      <t t-if="state.data and state.ids">
        <table class="table">
          <thead>
            <tr>
              <t t-foreach="state.data['columns']" t-as="colomn" t-key="colomn.id">
                <th>
                  <span>
                    <t t-esc="colomn.name" />
                  </span>
                </th>
              </t>
            </tr>
          </thead>
          <tbody>
            <t t-foreach="state.data['content']" t-as="data" t-key="data.name">
              <tr>
                <t t-foreach="state.ids" t-as="field" t-key="field">
                  <t t-if="field === 'name'">
                    <td style="'padding-left: 0px ;'">
                      <a t-on-click="() => openSaleOrder(data.id)">
                        <span t-esc="data[field]" />
                      </a>
                    </td>
                  </t>
                  <t t-else="">
                    <td class="text-center">
                      <span
                          t-esc="convertToHHMM(data[field])"
                          t-att-class="data[field] === 0 ?'text-muted' : ''"
                      />
                    </td>
                  </t>
                </t>
              </tr>
              <t t-if="data.sale_lines">
                <t t-foreach="data.sale_lines" t-as="saleLine" t-key='saleLine.name'>
                  <tr>
                    <t t-foreach="state.ids" t-as="field" t-key="field">
                      <t t-if="field === 'name'">
                        <td style="padding-left: 30px ;">
                          <span t-esc="saleLine[field]" />
                        </td>
                      </t>
                      <t t-else="">
                        <td class="text-center">
                          <span
                              t-esc="convertToHHMM(saleLine[field])"
                              t-att-class="saleLine[field] === 0 ?'text-muted' : ''"
                          />
                        </td>
                      </t>
                    </t>
                  </tr>
                  <t t-if="saleLine.employees">
                    <t t-foreach="saleLine.employees" t-as="employee" t-key='employee.name'>
                      <tr>
                        <t t-foreach="state.ids" t-as="field" t-key="field">
                          <t t-if="field === 'name'">
                            <td style="padding-left: 60px ;">
                              <span t-esc="employee[field]" />
                            </td>
                          </t>
                          <t t-else="">
                            <td class="text-center">
                              <span
                                  t-esc="convertToHHMM(employee[field])"
                                  t-att-class="employee[field] === 0 ?'text-muted' : ''"
                              />
                            </td>
                          </t>
                        </t>
                      </tr>
                    </t>
                  </t>
                </t>
              </t>
            </t>
          </tbody>
        </table>
      </t>
      <t t-else="">
        <p>Loading data...</p>
      </t>
    </div>
  </t>
</templates>
